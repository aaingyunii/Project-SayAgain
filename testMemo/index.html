<!DOCTYPE html>
<html lang="kr">
<head>
  <title>땡스피드</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
<!-- 네비게이션 바 시작 -->
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">땡쓰피드게시판</a>
      </div>
      <ul class="nav navbar-nav">
        <li class="active"><a href="/">Home</a></li>
        <li><a href="#">마이페이지</a></li>
        <li><a id="joinmenu" href="/join.html">가입</a></li>
        <li><a id="loginmenu" href="/login.html">로그인</a></li>
      </ul>
    </div>
  </nav>
<!-- 네비게이션 바 끝 -->


<!-- 점보트론 시작 -->
<div class="container">
  <div class="jumbotron">
    <h1>당신의 생각을 말해줘요.</h1> 
    <p>땡스피드는 오늘 하루 있었던 즐거운일, 감사한일, 행복한일을 적으며 하루를 마무리하는 게시판입니다.</p> 
  </div>
</div>
<!-- 점보트론 끝 -->

<!-- 쓰기 텍스트 필드 시작-->
<div class="container">
<div class="form-group">
  <label for="comment">오늘의 감사:</label>
  <textarea class="form-control" rows="5" id="comment"></textarea>
  <br>
    <!-- 쓰기 버튼 가운데 정렬 -->
   <div class="text-center"> 
      <button type="button" class="btn btn-success write" id="write" name="write">쓰기</button>
  </div>
</div>
</div>
<!-- 쓰기 텍스트 필드 끝-->




<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
<script>

  var emailAuth;
  var firebaseDatabase;
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCvdm7tFhiZdVQGhv3uc5nsiJtF1lr-JOw",
    authDomain: "testmemo-8978f.firebaseapp.com",
    databaseURL: "https://testmemo-8978f.firebaseio.com",
    projectId: "testmemo-8978f",
    storageBucket: "testmemo-8978f.appspot.com",
    messagingSenderId: "118296075968"
  };
  firebase.initializeApp(config);


emailAuth = firebase.auth();
firebaseDatabase=firebase.database();



//로그인이 되어있으면 - 유저가 있으면 user를 인자값으로 넘겨준다.
emailAuth.onAuthStateChanged(function(user) {
  if (user) {
   
   //조회 - 데이터 베이스에 저장된 닉네임을 현재 접속되어 있는 user의 pk key 값을 이용해서 가져오기
   firebaseDatabase.ref("users/"+user.uid).once('value').then(function(snapshot){
            //유저라는 부모 키 에
            //alert("로그인 되어 있군요 : " + user.uid);
            //alert(snapshot.val().name + "님 환영합니다");


      document.getElementById("loginmenu").textContent="로그아웃";
      document.getElementById("loginmenu").href="/logout.html"; 
      document.getElementById("joinmenu").textContent="반가워요! "+snapshot.val().name+ " 님";
      

    }); 



  }else{
    alert("로그인이 안되어 있네용")
  }
})


$(document).ready(function(){
  

  //쓰기버튼 눌렀을 때
  $(document).on('click','.write',function(){
    var comment = $('#comment').val();
    alert(comment);
  })




});


</script>

</body>
</html>